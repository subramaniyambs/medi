<!-- Title group  -->
<div class="title-group">
  <h1 class="mat-h1">Purchase Order List</h1>
  <mat-divider fxFlex="1 0"></mat-divider>
</div>

<p *ngIf="PurchaseOrderList.length <= 0" class="no-data">There is no Product added yet!</p>
<div class="example-container">
  <div class="col-md-4">
    <mat-form-field>
      <mat-label>Type</mat-label>
      <mat-select [(value)]="selected" placeholder="Types">
        <mat-option [value]="typeArray" *ngFor="let typeArray of typesProduct"
          (onSelectionChange)="typeMedicine($event, typeArray)">{{typeArray}}
        </mat-option>
      </mat-select>
      <!-- <mat-error *ngIf="handleError('type', 'required')">
          Type is required
      </mat-error> -->
    </mat-form-field>
  </div>
  <div class="col-md-4">
    <mat-form-field>
      <mat-select [formControl]="bankCtrl" placeholder="Medicine" #singleSelect>
        <mat-option>
          <ngx-mat-select-search [formControl]="bankFilterCtrl"></ngx-mat-select-search>
        </mat-option>
        <mat-option *ngFor="let bank of filteredBanks | async" [value]="bank">
          {{bank.product_name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div class="col-md-2">
    <!-- bankCtrl.value?.product_name -->
    <button mat-raised-button color="primary" (click)="AddMedicine(bankCtrl.value?.product_name)">ADD</button>
  </div>
  <div class="col-md-2" *ngIf="PurchaseOrderList.length > 0">
    <button mat-raised-button color="primary" [useExistingCss]="true" printSectionId="print-section" ngxPrint
      (click)="submitOrder()">print</button>
  </div>

<!-- 
  <p>
  Selected Bank: {{bankCtrl.value?.name}}
</p> -->
</div>

<!-- <div id="print-section" [hidden]="true" class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="invoice-title">
        <h2>Invoice</h2>
        <h3 class="pull-right">Order # 12345</h3>
      </div>
    </div>
  </div>
</div> -->


<div class="container" *ngIf="PurchaseOrderList.length > 0">
  <div id="print-section" class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource">
      <!-- <ng-container matColumnDef="_id">
        <th mat-header-cell *matHeaderCellDef> Product ID </th>
        <td mat-cell *matCellDef="let element"> {{element._id}} </td>
      </ng-container> -->

      <ng-container matColumnDef="Product_name">
        <th mat-header-cell *matHeaderCellDef> Item Name </th>
        <td mat-cell *matCellDef="let element"> {{element.product_name}} </td>
        <td mat-footer-cell *matFooterCellDef>  </td>
        <td mat-footer-cell *matFooterCellDef>  </td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef> Price </th>
        <td mat-cell *matCellDef="let element"> {{element.price}} </td>
        <td mat-footer-cell *matFooterCellDef style="padding-right: 50px">  <strong>Sub Total </strong> </td>
        <td mat-footer-cell *matFooterCellDef>  <strong>State GST </strong> </td>
      </ng-container>
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef> Quantity </th>
        <td mat-cell *matCellDef="let element">
          <!-- {{element.quantity}}  -->
          <input type="number" matInput placeholder="quantity" value="element.quantity" [(ngModel)]="element.quantity">
        </td>
        <td mat-footer-cell *matFooterCellDef> </td>
        <td mat-footer-cell *matFooterCellDef> </td>

      </ng-container>

      <!-- <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef> Type </th>
        <td mat-cell *matCellDef="let element"> {{element.type}} </td>
      </ng-container> -->
      <ng-container matColumnDef="total">
        <th mat-header-cell *matHeaderCellDef> Total </th>
        <td mat-cell *matCellDef="let element"> {{calculateTotal(element)}} </td>
        <td mat-footer-cell *matFooterCellDef>{{getTotalCost()}} 
          <!-- <span class="no-line text-center"><strong>Shipping</strong></span>
          <span class="no-line text-right">$15</span> -->
        </td> 
        <td mat-footer-cell *matFooterCellDef>{{getStateGST() | currency}} </td> 
      
      </ng-container>

      <ng-container matColumnDef="action">
        <th class="doNotPrint" mat-header-cell *matHeaderCellDef> Action </th>
        <td class="doNotPrint" mat-cell *matCellDef="let element; let i = index;">
          <button mat-raised-button color="accent" (click)="deleteProduct(i, element)">Delete</button>
        </td>
        <!-- {{getTotalCost() | currency}} -->
        <td mat-footer-cell *matFooterCellDef>  </td>
        <td mat-footer-cell *matFooterCellDef>  </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
    </table>
    <table style="width: 92%;padding-left: 436px;font-size: 14px;">
      <tr>
        <th><strong>State GST</strong></th>
        <td>{{getStateGST() | number : '1.2-2'}}</td>
      </tr>
      <tr>
        <th><strong>Central GST</strong></th>
        <td>{{getCentralGST() | number : '1.2-2'}}</td>
      </tr>
      <tr>
        <th><strong>Overall Total</strong></th>
        <td><strong>{{getOverAllTotal() | number : '1.2-2'}}</strong></td>
      </tr>
    </table>

    <!-- <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator> -->
  </div>
</div>